<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>NEI Processing · Emissions.jl</title><meta name="title" content="NEI Processing · Emissions.jl"/><meta property="og:title" content="NEI Processing · Emissions.jl"/><meta property="twitter:title" content="NEI Processing · Emissions.jl"/><meta name="description" content="Documentation for Emissions.jl."/><meta property="og:description" content="Documentation for Emissions.jl."/><meta property="twitter:description" content="Documentation for Emissions.jl."/><meta property="og:url" content="https://emissions.earthsci.dev/nei_processing/"/><meta property="twitter:url" content="https://emissions.earthsci.dev/nei_processing/"/><link rel="canonical" href="https://emissions.earthsci.dev/nei_processing/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Emissions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Complete Tutorial</a></li><li class="is-active"><a class="tocitem" href>NEI Processing</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Plume-Rise"><span>Plume Rise</span></a></li><li><a class="tocitem" href="#Constants-and-Unit-Conversions"><span>Constants and Unit Conversions</span></a></li><li><a class="tocitem" href="#Data-Types"><span>Data Types</span></a></li><li><a class="tocitem" href="#FF10-Data-Formats"><span>FF10 Data Formats</span></a></li><li><a class="tocitem" href="#I/O-Functions"><span>I/O Functions</span></a></li><li><a class="tocitem" href="#Spatial-Processing"><span>Spatial Processing</span></a></li><li><a class="tocitem" href="#Surrogate-Operations"><span>Surrogate Operations</span></a></li><li><a class="tocitem" href="#Output"><span>Output</span></a></li><li><a class="tocitem" href="#Pipeline-Functions"><span>Pipeline Functions</span></a></li></ul></li><li><a class="tocitem" href="../spatial_processing/">Spatial Processing Pipeline</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>NEI Processing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>NEI Processing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/Emissions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/Emissions.jl/blob/main/docs/src/nei_processing.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="NEI-Processing"><a class="docs-heading-anchor" href="#NEI-Processing">NEI Processing</a><a id="NEI-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#NEI-Processing" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The Emissions.jl package provides tools for processing EPA National Emissions Inventory (NEI) data. It supports reading FF10-format emissions files, spatial allocation using surrogate shapefiles, and gridding emissions to model-ready formats.</p><p>The package also includes plume rise calculations based on ASME (1973), as described in Seinfeld and Pandis, &quot;Atmospheric Chemistry and Physics - From Air Pollution to Climate Change&quot;.</p><h2 id="Plume-Rise"><a class="docs-heading-anchor" href="#Plume-Rise">Plume Rise</a><a id="Plume-Rise-1"></a><a class="docs-heading-anchor-permalink" href="#Plume-Rise" title="Permalink"></a></h2><p>The following functions implement the ASME (1973) plume rise algorithm:</p><ul><li><code>findLayer</code> - Find the model layer containing a given height</li><li><code>calcDeltaH</code> - Calculate plume rise</li><li><code>ASME</code> - Calculate effective emissions height with plume rise</li><li><code>calcDeltaHPrecomputed</code> - Calculate plume rise with precomputed meteorological parameters</li><li><code>ASMEPrecomputed</code> - Calculate effective emissions height with precomputed parameters</li></ul><h2 id="Constants-and-Unit-Conversions"><a class="docs-heading-anchor" href="#Constants-and-Unit-Conversions">Constants and Unit Conversions</a><a id="Constants-and-Unit-Conversions-1"></a><a class="docs-heading-anchor-permalink" href="#Constants-and-Unit-Conversions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Emissions.tonperyear"><a class="docstring-binding" href="#Emissions.tonperyear"><code>Emissions.tonperyear</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">tonperyear</code></pre><p>Conversion factor from tons per year to kg per second. 1 ton = 907.185 kg, 1 year = 31,536,000 seconds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/constants.jl#L3-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.tonpermonth"><a class="docstring-binding" href="#Emissions.tonpermonth"><code>Emissions.tonpermonth</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">tonpermonth</code></pre><p>Conversion factor from tons per month to kg per second. 1 ton = 907.185 kg, 1 month = 2,628,288 seconds (average month).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/constants.jl#L11-L16">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.foot"><a class="docstring-binding" href="#Emissions.foot"><code>Emissions.foot</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">foot</code></pre><p>Conversion factor from feet to meters. 1 foot = 0.3048 meters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/constants.jl#L19-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.kelvin"><a class="docstring-binding" href="#Emissions.kelvin"><code>Emissions.kelvin</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">kelvin(F)</code></pre><p>Convert temperature from Fahrenheit to Kelvin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/constants.jl#L27-L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.Pollutants"><a class="docstring-binding" href="#Emissions.Pollutants"><code>Emissions.Pollutants</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">Pollutants</code></pre><p>Dictionary mapping specific pollutant identifiers to aggregated pollutant group names.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/constants.jl#L34-L38">source</a></section></details></article><h2 id="Data-Types"><a class="docs-heading-anchor" href="#Data-Types">Data Types</a><a id="Data-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Types" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Emissions.EmissionsDataFrame"><a class="docstring-binding" href="#Emissions.EmissionsDataFrame"><code>Emissions.EmissionsDataFrame</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">EmissionsDataFrame</code></pre><p>Abstract type for emissions data frames wrapping FF10 format data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/types.jl#L4-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.SurrogateSpec"><a class="docstring-binding" href="#Emissions.SurrogateSpec"><code>Emissions.SurrogateSpec</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SurrogateSpec</code></pre><p>Holds surrogate specification data for spatial allocation of emissions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/types.jl#L11-L15">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.GridDef"><a class="docstring-binding" href="#Emissions.GridDef"><code>Emissions.GridDef</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">GridDef</code></pre><p>Specifies the grid that we are allocating the emissions to.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/types.jl#L32-L36">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.SpatialProcessor"><a class="docstring-binding" href="#Emissions.SpatialProcessor"><code>Emissions.SpatialProcessor</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SpatialProcessor</code></pre><p>Spatializes emissions records using surrogate specifications and grid definitions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/types.jl#L46-L50">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.Config"><a class="docstring-binding" href="#Emissions.Config"><code>Emissions.Config</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Config</code></pre><p>Holds configuration data for the emissions processing pipeline.</p><p><strong>Fields</strong></p><ul><li><code>f_gridRef</code>: Paths to grid reference files</li><li><code>SrgSpec</code>: Path to surrogate specification file</li><li><code>SrgShapefileDirectory</code>: Directory containing surrogate shapefiles</li><li><code>InputSR</code>: Input spatial reference (projection string)</li><li><code>OutputSR</code>: Output spatial reference (projection string)</li><li><code>GridFile</code>: Path to grid definition file</li><li><code>GridName</code>: Name of the grid</li><li><code>Counties</code>: Path to counties shapefile</li><li><code>EmisShp</code>: Path to output emissions shapefile directory</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/types.jl#L61-L76">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.IndexInfo"><a class="docstring-binding" href="#Emissions.IndexInfo"><code>Emissions.IndexInfo</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">IndexInfo</code></pre><p>Holds grid index information for gridded emissions, including which grid cells a source maps to and the fraction of emissions allocated to each cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/types.jl#L89-L94">source</a></section></details></article><h2 id="FF10-Data-Formats"><a class="docs-heading-anchor" href="#FF10-Data-Formats">FF10 Data Formats</a><a id="FF10-Data-Formats-1"></a><a class="docs-heading-anchor-permalink" href="#FF10-Data-Formats" title="Permalink"></a></h2><p>The EPA FF10 (Flat File 10) format is the standard format for emissions inventory data. The package supports four FF10 format types:</p><article><details class="docstring" open="true"><summary id="Emissions.FF10NonPointDataFrame"><a class="docstring-binding" href="#Emissions.FF10NonPointDataFrame"><code>Emissions.FF10NonPointDataFrame</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">FF10NonPointDataFrame &lt;: EmissionsDataFrame</code></pre><p>Wrapper for EPA FF10 nonpoint emissions data. Validates that the DataFrame has 45 columns, renames them to standard names, standardizes FIPS/SCC codes, and converts units.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/ff10.jl#L69-L74">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.FF10PointDataFrame"><a class="docstring-binding" href="#Emissions.FF10PointDataFrame"><code>Emissions.FF10PointDataFrame</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">FF10PointDataFrame &lt;: EmissionsDataFrame</code></pre><p>Wrapper for EPA FF10 point source emissions data. Validates that the DataFrame has 77 columns, renames them to standard names, standardizes FIPS/SCC codes, converts units, and converts stack parameters from imperial to SI units.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/ff10.jl#L114-L120">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.FF10NonRoadDataFrame"><a class="docstring-binding" href="#Emissions.FF10NonRoadDataFrame"><code>Emissions.FF10NonRoadDataFrame</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">FF10NonRoadDataFrame &lt;: EmissionsDataFrame</code></pre><p>Wrapper for EPA FF10 nonroad emissions data. Uses the same format as nonpoint.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/ff10.jl#L92-L96">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.FF10OnRoadDataFrame"><a class="docstring-binding" href="#Emissions.FF10OnRoadDataFrame"><code>Emissions.FF10OnRoadDataFrame</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">FF10OnRoadDataFrame &lt;: EmissionsDataFrame</code></pre><p>Wrapper for EPA FF10 on-road emissions data. Uses the same format as nonpoint.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/ff10.jl#L103-L107">source</a></section></details></article><h2 id="I/O-Functions"><a class="docs-heading-anchor" href="#I/O-Functions">I/O Functions</a><a id="I/O-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#I/O-Functions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Emissions.strip_missing"><a class="docstring-binding" href="#Emissions.strip_missing"><code>Emissions.strip_missing</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">strip_missing(df::DataFrame)</code></pre><p>Replace all <code>missing</code> values in a DataFrame with empty strings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/io.jl#L4-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.getCountry"><a class="docstring-binding" href="#Emissions.getCountry"><code>Emissions.getCountry</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">getCountry(fips::AbstractString)</code></pre><p>Return the country name based on the first digit of the FIPS code.</p><ul><li>&#39;0&#39; or &#39;9&#39; =&gt; &quot;US&quot;</li><li>&#39;1&#39; =&gt; &quot;Mexico&quot;</li><li>&#39;2&#39; =&gt; &quot;Canada&quot;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/io.jl#L16-L23">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.read_grid"><a class="docstring-binding" href="#Emissions.read_grid"><code>Emissions.read_grid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">read_grid(file::AbstractString)</code></pre><p>Read a grid definition file (IOAPI-style GRIDDESC format) and return a DataFrame with columns FIPS, Longitude, and Latitude.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/io.jl#L103-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.getShapefilePath"><a class="docstring-binding" href="#Emissions.getShapefilePath"><code>Emissions.getShapefilePath</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">getShapefilePath(dir::AbstractString, name::AbstractString, check::Bool=true)</code></pre><p>Find the full path to a shapefile within the given directory tree. Searches recursively for files with <code>.shp</code> extension matching the given name.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/io.jl#L133-L138">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.validateShapefile"><a class="docstring-binding" href="#Emissions.validateShapefile"><code>Emissions.validateShapefile</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">validateShapefile(path::AbstractString)</code></pre><p>Check that a shapefile path is non-empty and the file exists.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/io.jl#L160-L164">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.readSrgSpecSMOKE"><a class="docstring-binding" href="#Emissions.readSrgSpecSMOKE"><code>Emissions.readSrgSpecSMOKE</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">readSrgSpecSMOKE(file::AbstractString, SrgShapefileDirectory::AbstractString, CheckShapefiles::Bool=false)</code></pre><p>Read a SMOKE-format spatial surrogate specification file and return a vector of <code>SurrogateSpec</code> objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/io.jl#L169-L174">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.NewSpatialProcessor"><a class="docstring-binding" href="#Emissions.NewSpatialProcessor"><code>Emissions.NewSpatialProcessor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">NewSpatialProcessor(srgSpecs, grids, gridRef, inputSR, matchFullSCC)</code></pre><p>Create a new <code>SpatialProcessor</code> with default cache and merge depth settings.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/io.jl#L243-L247">source</a></section></details></article><h2 id="Spatial-Processing"><a class="docs-heading-anchor" href="#Spatial-Processing">Spatial Processing</a><a id="Spatial-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-Processing" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Emissions.NewPolygon"><a class="docstring-binding" href="#Emissions.NewPolygon"><code>Emissions.NewPolygon</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">NewPolygon(coords::Vector{Tuple{Float64,Float64}})</code></pre><p>Create a LibGEOS polygon from a vector of coordinate tuples. The polygon is automatically closed if needed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L4-L9">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.NewGridIrregular"><a class="docstring-binding" href="#Emissions.NewGridIrregular"><code>Emissions.NewGridIrregular</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">NewGridIrregular(name, nx, ny, sr, dx, dy, x0, y0)</code></pre><p>Create a <code>GridDef</code> with a regular (but potentially projected) grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L18-L22">source</a></section><section><div><pre><code class="language-julia hljs">NewGridIrregular(name, filepath, inputSR, outputSR)</code></pre><p>Create an irregular grid by reading polygon coordinates from a file. The file should contain polygon coordinate strings in the format used by the NEI processing notebook.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L46-L51">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.setupSpatialProcessor"><a class="docstring-binding" href="#Emissions.setupSpatialProcessor"><code>Emissions.setupSpatialProcessor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">setupSpatialProcessor(config::Config)</code></pre><p>Set up a <code>SpatialProcessor</code> from a configuration object. Reads grid reference files, surrogate specifications, and grid definitions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L109-L114">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.findCountyPolygon"><a class="docstring-binding" href="#Emissions.findCountyPolygon"><code>Emissions.findCountyPolygon</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">findCountyPolygon(fips::AbstractString, countyShapefile::AbstractString)</code></pre><p>Find and return the polygon for a given FIPS code from a county shapefile.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L136-L140">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.GetIndex"><a class="docstring-binding" href="#Emissions.GetIndex"><code>Emissions.GetIndex</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">GetIndex(point_or_poly, grid::GridDef)</code></pre><p>Find which grid cells a point or polygon intersects, and return an <code>IndexInfo</code> with the row/column indices and fractional coverage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L153-L158">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.recordToGrid"><a class="docstring-binding" href="#Emissions.recordToGrid"><code>Emissions.recordToGrid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">recordToGrid(emissions::Float64, index::IndexInfo, grid_nx::Int, grid_ny::Int)</code></pre><p>Distribute emissions to grid cells according to the fractional coverage in <code>IndexInfo</code>. Returns a sparse matrix of emissions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L217-L222">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.GridFactors"><a class="docstring-binding" href="#Emissions.GridFactors"><code>Emissions.GridFactors</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">GridFactors(grid::GridDef)</code></pre><p>Return a matrix of grid cell areas.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L231-L235">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.uniqueCoordinates"><a class="docstring-binding" href="#Emissions.uniqueCoordinates"><code>Emissions.uniqueCoordinates</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">uniqueCoordinates(lons::Vector{Float64}, lats::Vector{Float64})</code></pre><p>Return the indices of unique (lon, lat) coordinate pairs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L247-L251">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.uniqueLoc"><a class="docstring-binding" href="#Emissions.uniqueLoc"><code>Emissions.uniqueLoc</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">uniqueLoc(lons::Vector{Float64}, lats::Vector{Float64})</code></pre><p>Return a dictionary mapping unique (lon, lat) pairs to their first occurrence index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/spatial.jl#L265-L269">source</a></section></details></article><h2 id="Surrogate-Operations"><a class="docs-heading-anchor" href="#Surrogate-Operations">Surrogate Operations</a><a id="Surrogate-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Surrogate-Operations" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Emissions.generate_data_sparse_matrices"><a class="docstring-binding" href="#Emissions.generate_data_sparse_matrices"><code>Emissions.generate_data_sparse_matrices</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">generate_data_sparse_matrices(shapefile_path, attribute, grid, inputSR)</code></pre><p>Read a data shapefile and generate sparse matrices representing the spatial allocation of each region (identified by <code>attribute</code>) to grid cells. Returns a dictionary mapping attribute values to sparse matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/surrogates.jl#L42-L48">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.generate_weight_sparse_matrices"><a class="docstring-binding" href="#Emissions.generate_weight_sparse_matrices"><code>Emissions.generate_weight_sparse_matrices</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">generate_weight_sparse_matrices(shapefile_path, weight_columns, weight_factors, grid, inputSR)</code></pre><p>Read a weight shapefile and generate sparse matrices of weighted values on the grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/surrogates.jl#L85-L89">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.generate_grid_sparse_matrices"><a class="docstring-binding" href="#Emissions.generate_grid_sparse_matrices"><code>Emissions.generate_grid_sparse_matrices</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">generate_grid_sparse_matrices(grid::GridDef)</code></pre><p>Generate a sparse matrix of grid cell areas.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/surrogates.jl#L130-L134">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.generate_countySurrogate"><a class="docstring-binding" href="#Emissions.generate_countySurrogate"><code>Emissions.generate_countySurrogate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">generate_countySurrogate(data_matrices, weight_matrix, grid_matrix)</code></pre><p>Generate a surrogate matrix by combining data and weight matrices. For each region in data_matrices, the surrogate is computed as:   surrogate = (data .* weight) / sum(data .* weight) Falls back to area-based allocation if weight sum is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/surrogates.jl#L146-L153">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.update_locIndex"><a class="docstring-binding" href="#Emissions.update_locIndex"><code>Emissions.update_locIndex</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">update_locIndex(locIndex::Dict, fips::AbstractString, surrogates::Dict)</code></pre><p>Update a location index dictionary with surrogate allocation data for a given FIPS code. Returns the IndexInfo for the FIPS code from the surrogates, or a default empty IndexInfo.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/surrogates.jl#L180-L185">source</a></section></details></article><h2 id="Output"><a class="docs-heading-anchor" href="#Output">Output</a><a id="Output-1"></a><a class="docs-heading-anchor-permalink" href="#Output" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Emissions.find_surrogate_by_code"><a class="docstring-binding" href="#Emissions.find_surrogate_by_code"><code>Emissions.find_surrogate_by_code</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_surrogate_by_code(srgSpecs::Vector{SurrogateSpec}, code::Int)</code></pre><p>Find a surrogate specification by its code number. Returns the matching <code>SurrogateSpec</code> or <code>nothing</code> if not found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/output.jl#L19-L24">source</a></section><section><div><pre><code class="language-julia hljs">find_surrogate_by_code(srgSpecs::Vector{SurrogateSpec}, region::String, code::Int)</code></pre><p>Find a surrogate specification by its region and code number. Returns the matching <code>SurrogateSpec</code> or <code>nothing</code> if not found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/output.jl#L34-L39">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.get_data_weight_shapefiles"><a class="docstring-binding" href="#Emissions.get_data_weight_shapefiles"><code>Emissions.get_data_weight_shapefiles</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_data_weight_shapefiles(srg::SurrogateSpec)</code></pre><p>Return a tuple of (data<em>shapefile, weight</em>shapefile) paths from a surrogate specification.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/output.jl#L49-L53">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Emissions.writeEmis"><a class="docstring-binding" href="#Emissions.writeEmis"><code>Emissions.writeEmis</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">writeEmis(filename, grid_data, grid::GridDef; pollutant=&quot;&quot;, units=&quot;&quot;)</code></pre><p>Write gridded emissions data to a CSV file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: Output file path</li><li><code>grid_data</code>: Matrix or sparse matrix of emissions values</li><li><code>grid</code>: Grid definition</li><li><code>pollutant</code>: Pollutant name (optional, for header)</li><li><code>units</code>: Units string (optional, for header)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Emissions.jl/blob/fef79645e9b42da7863fcbf5252fbdd1acf2bdfd/src/output.jl#L58-L69">source</a></section></details></article><h2 id="Pipeline-Functions"><a class="docs-heading-anchor" href="#Pipeline-Functions">Pipeline Functions</a><a id="Pipeline-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Pipeline-Functions" title="Permalink"></a></h2><p>See the <a href="../spatial_processing/#Spatial-Processing-Pipeline">Spatial Processing Pipeline</a> page for documentation on the mid-level pipeline functions: <code>read_ff10</code>, <code>normalize_country</code>, <code>read_gridref</code>, <code>aggregate_emissions</code>, <code>filter_known_pollutants</code>, <code>map_pollutant_names!</code>, <code>assign_surrogates</code>, and <code>build_data_weight_map</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Complete Tutorial</a><a class="docs-footer-nextpage" href="../spatial_processing/">Spatial Processing Pipeline »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 15 February 2026 00:52">Sunday 15 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
